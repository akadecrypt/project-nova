{
  "tools": [
    {
      "name": "execute_sql",
      "description": "DEFAULT AND PRIMARY TOOL FOR ALL READ OPERATIONS. Use this for ANY 'list', 'show', 'get', 'stats', 'analytics' request. Tables: bucket (bucket_id, bucket_name, bucket_owner, versioning, worm, created_at), bucket_stats (bucket_id, object_count, size_gb, timestamp). Examples: 'list buckets' = SELECT * FROM bucket; 'show stats' = SELECT b.bucket_name, bs.size_gb, bs.object_count FROM bucket b JOIN bucket_stats bs ON b.bucket_id = bs.bucket_id; 'object store stats' = same SQL query.",
      "category": "read_analytics",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "sql": {
            "type": "string",
            "description": "SQL query to execute. Common queries: 'SELECT * FROM bucket' for buckets, 'SELECT b.bucket_name, bs.size_gb, bs.object_count FROM bucket b JOIN bucket_stats bs ON b.bucket_id = bs.bucket_id' for stats"
          }
        },
        "required": ["sql"]
      },
      "examples": [
        "List all buckets → SELECT bucket_name, created_at FROM bucket",
        "Show bucket sizes → SELECT b.bucket_name, bs.size_gb FROM bucket b JOIN bucket_stats bs...",
        "Which buckets have WORM? → SELECT bucket_name FROM bucket WHERE worm_enabled = 1",
        "Storage growth this week → SELECT bucket_name, size_gb, timestamp FROM bucket_stats WHERE timestamp >= datetime('now', '-7 days')"
      ]
    },
    {
      "name": "get_table_schema",
      "description": "Get the schema (columns and types) for a database table. Use before writing complex SQL queries.",
      "category": "read_analytics",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "table_name": {
            "type": "string",
            "description": "Name of the table: 'bucket', 'bucket_stats', etc."
          }
        },
        "required": ["table_name"]
      },
      "examples": [
        "Describe the bucket table",
        "What columns are in bucket_stats?"
      ]
    },
    {
      "name": "list_tables",
      "description": "List all tables available in the analytics database for SQL queries.",
      "category": "read_analytics",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {}
      },
      "examples": [
        "What tables are available for analytics?"
      ]
    },
    {
      "name": "get_database_summary",
      "description": "Get complete database overview with all tables, columns, and row counts.",
      "category": "read_analytics",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {}
      },
      "examples": [
        "Give me a database overview"
      ]
    },
    {
      "name": "create_bucket",
      "description": "ACTION: Create a new S3 bucket via API. Only use for CREATE requests, NOT for listing.",
      "category": "write_action",
      "mode": "write",
      "parameters": {
        "type": "object",
        "properties": {
          "bucket_name": {
            "type": "string",
            "description": "Name of the bucket to create (lowercase, 3-63 chars)"
          }
        }
      },
      "examples": [
        "Create a bucket called 'my-data'",
        "Make a new bucket for backups"
      ]
    },
    {
      "name": "put_object",
      "description": "ACTION: Upload an object to a bucket via S3 API. Only use for upload/write requests.",
      "category": "write_action",
      "mode": "write",
      "parameters": {
        "type": "object",
        "properties": {
          "bucket_name": {
            "type": "string",
            "description": "Target bucket name"
          },
          "key": {
            "type": "string",
            "description": "Object key (filename/path)"
          },
          "content": {
            "type": "string",
            "description": "Text content to upload"
          }
        },
        "required": ["bucket_name", "key", "content"]
      },
      "examples": [
        "Upload test.txt to my-bucket",
        "Create a config file in settings bucket"
      ]
    },
    {
      "name": "delete_object",
      "description": "ACTION: Delete an object from a bucket via S3 API. Confirm with user first!",
      "category": "write_action",
      "mode": "write",
      "parameters": {
        "type": "object",
        "properties": {
          "bucket_name": {
            "type": "string",
            "description": "Bucket containing the object"
          },
          "key": {
            "type": "string",
            "description": "Object key to delete"
          }
        },
        "required": ["bucket_name", "key"]
      },
      "examples": [
        "Delete old-file.txt from bucket"
      ]
    },
    {
      "name": "list_objects",
      "description": "List objects currently in a specific bucket via S3 API. Use when user asks for LIVE/CURRENT objects in a specific bucket.",
      "category": "read_realtime",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "bucket_name": {
            "type": "string",
            "description": "Bucket name to list objects from"
          },
          "prefix": {
            "type": "string",
            "description": "Optional prefix filter"
          },
          "max_keys": {
            "type": "integer",
            "description": "Max objects to return (default: 1000)"
          }
        },
        "required": ["bucket_name"]
      },
      "examples": [
        "List objects in bucket 'my-data'",
        "Show files in logs bucket"
      ]
    },
    {
      "name": "get_bucket_info",
      "description": "Get live bucket info (object count, size) via S3 API for a specific bucket.",
      "category": "read_realtime",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "bucket_name": {
            "type": "string",
            "description": "Bucket name"
          }
        },
        "required": ["bucket_name"]
      },
      "examples": [
        "Get info about my-data bucket"
      ]
    },
    {
      "name": "get_object_stores",
      "description": "Get Object Store configurations (name, domain, UUID) from Prism Central. Use only when user asks about 'object store configuration' or 'which object stores exist'. For bucket stats or analytics, use execute_sql instead.",
      "category": "read_realtime",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {}
      },
      "examples": [
        "What object stores are configured?",
        "Show object store domains"
      ]
    },
    {
      "name": "fetch_object_store_stats_v4",
      "description": "ONLY USE when user EXPLICITLY asks for 'IOPS' or 'throughput' metrics. DO NOT use for general 'stats' or 'show stats' requests - use execute_sql instead! This tool is ONLY for real-time performance metrics like readIops, writeIops, readThroughputBps, writeThroughputBps.",
      "category": "read_realtime",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "object_store_ext_id": {
            "type": "string",
            "description": "Object store UUID (get from get_object_stores first)"
          },
          "start_time": {
            "type": "string",
            "description": "Start time ISO 8601 (e.g., '2024-01-20T00:00:00Z')"
          },
          "end_time": {
            "type": "string",
            "description": "End time ISO 8601 (e.g., '2024-01-20T23:59:59Z')"
          },
          "select_stats": {
            "type": "array",
            "items": {"type": "string"},
            "description": "ONLY: readIops, writeIops, readThroughputBps, writeThroughputBps"
          }
        },
        "required": ["object_store_ext_id", "start_time", "end_time"]
      },
      "examples": [
        "What is the current IOPS?",
        "Show read/write throughput"
      ]
    },
    {
      "name": "search_logs",
      "description": "Search log events (ERROR, WARN, FATAL) from cluster logs. Filter by severity, pod/component, event type, object store, bucket, and time range.",
      "category": "log_analysis",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "severity": {
            "type": "string",
            "description": "Filter by severity: ERROR, WARN, FATAL, INFO"
          },
          "pod": {
            "type": "string",
            "description": "Filter by component: OC (Object Controller), MS (Metadata Service), Atlas, Curator, Stargate"
          },
          "event_type": {
            "type": "string",
            "description": "Filter by event type: REPLICATION_FAIL, IO_ERROR, AUTH_FAIL, DISK_FULL, OOM, TIMEOUT, CONNECTION_FAIL, CORRUPTION, QUOTA_EXCEEDED, SERVICE_DOWN"
          },
          "object_store_name": {
            "type": "string",
            "description": "Filter by object store name"
          },
          "bucket_name": {
            "type": "string",
            "description": "Filter by bucket name"
          },
          "hours": {
            "type": "integer",
            "description": "Time range in hours (default: 24)"
          },
          "limit": {
            "type": "integer",
            "description": "Max results to return (default: 50)"
          }
        }
      },
      "examples": [
        "Show me errors from the last 24 hours",
        "Find FATAL events in OC component",
        "Search for replication failures",
        "Show warnings for bucket customer-uploads"
      ]
    },
    {
      "name": "get_error_summary",
      "description": "Get a summary of errors and warnings from cluster logs. Returns counts by severity, component (pod), and event type.",
      "category": "log_analysis",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "hours": {
            "type": "integer",
            "description": "Time range in hours (default: 24)"
          }
        }
      },
      "examples": [
        "Summarize errors from the last 24 hours",
        "What errors occurred today?",
        "Give me an error breakdown",
        "How many warnings do we have?"
      ]
    },
    {
      "name": "get_log_trends",
      "description": "Get log error/warning trends over time. Shows daily counts for trend analysis.",
      "category": "log_analysis",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "days": {
            "type": "integer",
            "description": "Number of days to analyze (default: 7)"
          }
        }
      },
      "examples": [
        "Show error trends for the past week",
        "Are errors increasing or decreasing?",
        "Log trends over 14 days"
      ]
    },
    {
      "name": "get_log_details",
      "description": "Get detailed information about a specific log event including full message, stack trace, and raw log file location.",
      "category": "log_analysis",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "log_id": {
            "type": "integer",
            "description": "The log event ID"
          }
        },
        "required": ["log_id"]
      },
      "examples": [
        "Show details for log ID 123",
        "Get more info about that error"
      ]
    },
    {
      "name": "get_related_events",
      "description": "Find log events related to a specific event (same time window, same component, or same event type).",
      "category": "log_analysis",
      "mode": "read",
      "parameters": {
        "type": "object",
        "properties": {
          "log_id": {
            "type": "integer",
            "description": "Reference log event ID"
          },
          "limit": {
            "type": "integer",
            "description": "Max related events to return (default: 10)"
          }
        },
        "required": ["log_id"]
      },
      "examples": [
        "Find events related to log 123",
        "What else happened around that error?"
      ]
    }
  ],
  "categories": {
    "read_analytics": {
      "name": "Analytics (SQL Database)",
      "description": "PRIMARY for all read/list/stats operations - query the SQL analytics database",
      "icon": "database",
      "mode": "read"
    },
    "read_realtime": {
      "name": "Real-time Queries (API)",
      "description": "Live object listing and Prism Central metrics",
      "icon": "refresh",
      "mode": "read"
    },
    "write_action": {
      "name": "Actions (API)",
      "description": "Create, upload, delete operations via S3/Prism API",
      "icon": "edit",
      "mode": "write"
    },
    "log_analysis": {
      "name": "Log Analysis",
      "description": "Search and analyze cluster log events (ERROR, WARN, FATAL)",
      "icon": "file-text",
      "mode": "read"
    }
  },
  "mode_rules": {
    "read": {
      "primary_tool": "execute_sql",
      "description": "Use SQL database for all list/show/get/stats requests",
      "keywords": ["list", "show", "get", "display", "what", "which", "how many", "stats", "analytics", "trend", "growth"]
    },
    "write": {
      "tools": ["create_bucket", "put_object", "delete_object"],
      "description": "Use API for create/upload/delete/modify operations",
      "keywords": ["create", "make", "upload", "put", "delete", "remove", "modify", "update", "configure"]
    }
  }
}
